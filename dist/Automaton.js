export class Automaton{constructor(json){this.transitions=json.transitions;this.startNode=json.startNode;this.endNodes=json.endNodes;this.currentNode=this.startNode;this.alphabet=Array.from(json.alphabet);this.nodes=json.states}next_step(next_char){let x=this.nodes.indexOf(this.currentNode);let y=this.alphabet.indexOf(next_char);this.currentNode=this.transitions[x][y]}restart(){this.currentNode=this.startNode}draw_next_step(next_char){this.color_node(false);this.next_step(next_char);this.color_node(true)}initiate_graph(){let automatonHTML=document.getElementById("automaton-mermaid");automatonHTML.removeAttribute("data-processed");automatonHTML.innerHTML=this.matrix_to_mermaid();mermaid.init(document.querySelectorAll(".mermaid"));this.endNodes.forEach(n=>{let circle=this.get_current_graph_node(n);let smaller_circle=circle.cloneNode();smaller_circle.attributes["r"].value-=3;circle.parentNode.insertBefore(smaller_circle,circle.nextSibling)});this.color_node(true)}get_current_graph_node(node){let elts=document.querySelectorAll(".node").values();let currentNode=elts.next();while(elts){if(currentNode.value.getElementsByClassName("nodeLabel")[0].innerHTML==node)break;currentNode=elts.next()}return currentNode.value.firstChild}matrix_to_mermaid(){let res="flowchart LR";res=res.concat("\n"+this.create_entering_arrow());for(let i=0;i<this.nodes.length;i++){for(let j=0;j<this.alphabet.length;j++){res=res.concat("\n");res=res.concat(this.create_triple(this.nodes[i],this.alphabet[j],this.transitions[i][j]))}}res=res.concat("\nstyle START fill:#FFFFFF, stroke:#FFFFFF;");console.log(res);return res}color_node(toFill){let current_circle=this.get_current_graph_node(this.currentNode);let next_circle=current_circle.nextSibling;if(toFill){if(this.endNodes.includes(this.currentNode))next_circle.style.fill="#009879";else current_circle.style.fill="#009879"}else{if(this.endNodes.includes(this.currentNode))next_circle.removeAttribute("style");else current_circle.removeAttribute("style")}}create_triple(A,transition,B){return`${A}((${A})) -->| ${transition} | ${B}((${B}))`}create_entering_arrow(){return`START[ ]--> ${this.startNode}`}}
//# sourceMappingURL=Automaton.js.map