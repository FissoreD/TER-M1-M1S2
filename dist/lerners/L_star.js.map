{"version":3,"sources":["../../src/lerners/L_star.ts"],"names":["Automaton","State","LernerBase","L_star","constructor","teacher","update_observation_table","key","value","old_value","observation_table","undefined","make_automaton","wordForState","statesMap","Map","acceptingStates","initialStates","statesSet","Set","S","forEach","s","name","get","state","alphabet","push","isAccepting","isInitial","set","add","word","symbol","outTransitions","automaton","is_close","SA","find","t","some","same_row","is_consistent","s1_ind","length","s2_ind","s1","s2","a","i","E","includes","b","table_to_update_after_equiv","answer","add_elt_in_S"],"mappings":"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","sourcesContent":["import { Automaton, State } from \"../automaton/Automaton.js\";\r\nimport { Teacher } from \"../teacher/Teacher.js\";\r\nimport { LernerBase, Map_string_string } from \"./LernerBase.js\";\r\n\r\nexport class L_star extends LernerBase {\r\n\r\n  constructor(teacher: Teacher) {\r\n    super(teacher)\r\n  }\r\n\r\n  update_observation_table(key: string, value: string) {\r\n    let old_value = this.observation_table[key];\r\n    if (old_value != undefined) value = old_value + value\r\n    this.observation_table[key] = value;\r\n  }\r\n\r\n  make_automaton(): Automaton {\r\n    let wordForState: string[] = [], statesMap: Map<string, State> = new Map(),\r\n      acceptingStates: State[] = [], initialStates: State[] = [], statesSet: Set<State> = new Set();\r\n    this.S.forEach(s => {\r\n      let name = this.observation_table[s];\r\n      if (!statesMap.get(name)) {\r\n        let state = new State(name, name[0] == \"1\", s == \"\", this.alphabet);\r\n        wordForState.push(s);\r\n        if (state.isAccepting) acceptingStates.push(state)\r\n        if (state.isInitial) initialStates.push(state)\r\n        statesMap.set(name, state);\r\n        statesSet.add(state)\r\n      }\r\n    })\r\n\r\n    for (const word of wordForState) {\r\n      let name = this.observation_table[word]\r\n      for (const symbol of this.alphabet) {\r\n        statesMap.get(name)!.outTransitions.get(symbol)!.push(statesMap.get(this.observation_table[word + symbol])!)\r\n      }\r\n    }\r\n\r\n    this.automaton = new Automaton(statesSet)\r\n    return this.automaton;\r\n  }\r\n\r\n\r\n  /**\r\n   * @returns the first t in SA st it does not exist s in S st row(s) == row (t)\r\n   */\r\n  is_close(): string | undefined {\r\n    return this.SA.find(t => !this.S.some(s => this.same_row(s, t)));\r\n  }\r\n\r\n  /**\r\n   * @returns a list of 3 elements, \r\n   * the first two are s1, s2 in {@link S} st row(s1) == row(s2)\r\n   * and there is an \"a\" in alphabet st row(s1 + a) != row(s2 + a)\r\n   */\r\n  is_consistent(): string[] | undefined {\r\n    for (let s1_ind = 0; s1_ind < this.S.length; s1_ind++) {\r\n      for (let s2_ind = s1_ind + 1; s2_ind < this.S.length; s2_ind++) {\r\n        let s1 = this.S[s1_ind];\r\n        let s2 = this.S[s2_ind];\r\n        if (this.same_row(s1, s2)) {\r\n          for (const a of this.alphabet) {\r\n            for (let i = 0; i < this.E.length; i++) {\r\n              if (this.observation_table[s1 + a][i] !=\r\n                this.observation_table[s2 + a][i] && !this.E.includes(a + this.E[i]))\r\n                return [s1, s2, a + this.E[i]]\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  same_row(a: string, b: string) {\r\n    return this.observation_table[a] == this.observation_table[b];\r\n  }\r\n\r\n\r\n  table_to_update_after_equiv(answer: string): void {\r\n    this.add_elt_in_S(answer);\r\n  }\r\n}"],"file":"L_star.js"}